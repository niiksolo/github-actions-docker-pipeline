name: CD

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  deploy-staging:
    if: ${{ github.event_name == 'workflow_dispatch' }}
    runs-on: ubuntu-latest
    environment: staging
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Deploy to staging
        run: |
          echo "ðŸš€ Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð½Ð° STAGING..."
          # docker-compose up / kubectl apply
          echo "âœ… Staging Ð´ÐµÐ¿Ð»Ð¾Ð¹ Ð·Ð°Ð²ÐµÑ€ÑˆÑ‘Ð½"

  deploy-prod:
    if: ${{ github.event_name == 'push' && github.ref == 'refs/heads/main' }}
    runs-on: ubuntu-latest
    environment: production
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Deploy to prod
        run: |
          echo "ðŸš€ Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð½Ð° PROD..."
          # docker-compose up / helm upgrade
          echo "âœ… Production Ð´ÐµÐ¿Ð»Ð¾Ð¹ Ð·Ð°Ð²ÐµÑ€ÑˆÑ‘Ð½"